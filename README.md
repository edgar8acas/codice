# CÃ³dice

Full stack web application, aimed at aiding deaf people to improve their vocabulary through interactive readings.

## Built with

- Node
- R
- Vue
- PostgreSQL

## Required OS

Tested in Windows 10 and Linux, though it should work in Mac OS as well.

## Required software (latest stable versions):

- R programming language  
  [Windows](https://cloud.r-project.org/bin/windows/base/R-4.0.2-win.exe)
- Node and Npm package manager  
  [Windows](https://nodejs.org/dist/v12.18.4/node-v12.18.4-x64.msi)
- PostgreSQL  
  [Windows](https://www.enterprisedb.com/downloads/postgres-postgresql-downloads)

## Setup

### R setup

We need to install the following packages for the script to function properly:

- tm
- jsonlite
- quanteda
- dplyr
- tibble

1. Start the R command line as administrator

```
R
```

2. Each package can be installed with the following command

```
install.packages("package-name")
```

**NOTE**: In Windows, we have to make sure the bin folder of the R installation is included in the system PATH environment variable.
The folder is normally located here: _C:\Program Files\R\R-4.0.2\bin_

### Database setup

When installing PostgreSQL, we are asked to enter the password that will be used for the default role.

After the installation is completed, we need to open the interactive terminal in order to execute the necessary commands to create the database. The terminal is available in Windows as "SQL Shell" while in Linux we can use the **psql** command.

Right now, we have a default role called _postgres_. Which can be used to connect the node application and the database server, though it's not recommended for security reasons.
Therefore, we are going to create a new role:

```
CREATE ROLE codice1 WITH LOGIN CREATEDB PASSWORD 'codice1';
```

And a new database:

```
CREATE DATABASE codice_dev WITH OWNER codice1;
```

**NOTE**: we can customize the role, password and database name, but we will also need to change the corresponding data in _config/database.config.js_ file.

We can now close the shell and re-enter with our new credentials.

The database structure as well as the example data can be generated by executing the SQL scripts present in the [_src/server/database_](./src/server/database) folder. A more convenient option is to run the command `yarn migrate` after installing the project dependencies as shown in the [Project setup](#project-setup).

The script [create-tables.sql](./src/server/database/create-tables.sql) contains the table creation commands and the scripts starting with **insert-\*** contain commands to populate the database with example data.

### Project setup

Installing dependencies inside the project root folder:

```
yarn install
```

The nodemon package is useful for development, we can install it as a dependency or globally with:

```
yarn global add nodemon
```

To start the development server, we need to execute the command:

```
yarn dev
```

This command will start both frontend and backend services in different ports. The server will be available in localhost:5000 and the frontend in localhost:3000.

### Production setup

The following command will bundle our frontend sources and place them in the _src/server/dist_ folder, (this folder is not included in the source code and will be generated automatically by running the command).

```
yarn build
```

Now the project can be started with:

```
yarn start
```

Both server and frontend will be available in _localhost:5000_.

**NOTE**: In a production environment, the database credentials should be placed in a text file called _.env_
that should be located in the root folder of the project, following this format:

```
PROD_DB_DATABASE=example_db
PROD_DB_USERNAME=example_username
PROD_DB_PASSWORD=example_password
PROD_DB_HOST=example_host
```
